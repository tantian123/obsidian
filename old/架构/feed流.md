feed 信息单元

Feed 流的本质是 M 个用户订阅了 N 个信息源形成的多对多关系，Feed 流系统需要聚合用户订阅的 N 个信息源产生的信息单元(Feed)，并按照一定顺序排列后推送给用户。


发布者的数据：例如 发布者信息 发布微博的内容
关注关系 ：谁关注了发布者
接受者的消息：从不同发布者获取的消息数据 按照时间顺序组合在一起

同步方式：
推模式 拉模式 推拉模式
- 推模式：当新的 Feed 发布后，将这条内容插入到发布者所有粉丝的 Feed 流中。
- 拉模式：收到用户拉取Feed流请求后遍历他的关注关系，并拉取关注的人发布的内容实时聚合成 Feed 流。

在线推 离线拉 



存储
最轻量的解决方案是使用 Redis 存储 Feed 流。
Redis 的 SortedSet 是非常适合存储 Feed 流的数据结构。一般以 Feed 的 ID 作为 SortedSet 的 member，时间戳或者热度值、推荐值作为 score 进行排序。SortedSet 保证了 Feed 不会重复，且插入过程线程安全，无论是推拉模式实现起来都非常方便。


如何设计
先看用户规模 TPS和QPS

feed流的两大核心问题 是存储和推送

存储的一是关注列表或者说是好友关系 二是Feed消息内容
