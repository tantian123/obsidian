基于消息模式

有两种方式 基于消息队列和本地消息表，

存在两个问题
1.本地事务完成后，确保发送消息到下游
2.确保消息幂等


本地消息表
**将业务的执行和将消息放入消息表中的操作放在同一个事务中提交**
这样本地事务执行成功的话，消息肯定也插入成功，然后再调用其他服务，如果调用成功就修改这条本地消息的状态。失败也会一直有个线程扫描这个表，进行重发。