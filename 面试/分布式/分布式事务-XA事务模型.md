**XA事务模型**
使用了哪种协商协议（2PC、3PC)
2PC
分为准备 提交/回滚
协调者发送消息（准备消息）给参与者，
参与者收到消息后执行事务操作，然后返回消息（是否准备成功）
协调者根据返回的消息，选择发送提交/回滚


![[Pasted image 20241204212407.png]]

![[Pasted image 20241204212432.png]]

考虑机器宕机或者消息丢失
参与者挂掉 
协调者挂掉
网络分区导致消息丢失

问题：
1.性能（同步阻塞） 一阶段后所有资源处于锁定
2.极端情况下的不一致  
3.依赖于协调者 协调者挂了就完了


3PC
3PC 的引入是为了解决 2PC 同步阻塞和减少数据不一致的情况。

3PC包括询问阶段、准备阶段、提交阶段,相对于2PC来说增加了一个询问阶段，然后准备阶段和2PC的准备阶段大致类似，只是增加了参与者允许超时的机制

 