发送ABC 和DEF 
如果接收到ABCDEF就是粘包
接收到AB CD EF就是半包

为什么（**从发送方缓冲区和接收方缓冲区两个角度**）
发送方发送的数据太小 远小于缓存区大小 网卡不会立马发送即合并发送
或者是接收方读取数据不够及时

发送方发送的数据大于缓冲区 这样必然会多次发
或者发送的数据大于MTU(最大传输单元) 必须拆包

**根本原因是TCP是流协议 消息无边界**
UDP的包之间是有界限的，就没有这些问题


处理方式：
1.tcp改为短连接，每次请求一个连接，但是效率低
2.封装为帧 固定长度 不够就补全 但是浪费空间
3.封装为帧 编码时加上分隔符 缺点是需要转义可能有冲突
4.（推荐）封装为帧 解析前面的固定长度获取整个消息的长度 然后读取后面内容

![[Pasted image 20231221231456.png]]


结合源码
decoder的channelRead
用到了模板模式有一个抽象方法decode