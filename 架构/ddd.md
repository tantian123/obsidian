领域驱动设计

先堆概念

领域模型 domain model
上下文 context
上下文边界
值对象
聚合
聚合根
领域服务
领域事件
限界上下文

然后分析某个具体的例子 

用户 视频 频道
直播  文章 
推荐 广告
收藏 购物
游戏
社区
支付
消息

如何实现：
确定限界上下文，然后定领域模型，定义领域服务，最后找领域事件，根据业务不断迭代

1.领域模型：
领域模型通常会包括聚合根、实体、值对象、服务、工厂等概念

2.聚合根、实体和值对象的区别：
实体主要用于描述具有唯一身份标识和生命周期的业务对象，而值对象主要用于描述无需唯一身份标识、不可变、无生命周期、属性值完全相等的业务对象。聚合根是一组相关的实体和值对象的集合，它们共同组成了一个完整的业务概念单元。

在bilibili的视频业务中，实体是视频 用户 评论 ，值对象是视频元数据（标题 标签）
聚合根是实体和值对象的集合，即视频元数据 用户 评论等元素组成的视频这个概念

3.聚合和聚合根
在一个聚合内，存在一个聚合根，它是聚合中的**一个实体**，负责协调和管理聚合中的其他实体和值对象。聚合根是聚合中最重要、最核心的实体，它具有唯一的身份标识，可以用来唯一地标识整个聚合。

在bilibili的视频业务中，聚合和聚合根都是视频，用户这个实体可能会存在视频和评论这两个聚合中，但是都不是聚合根

4.领域服务 domain service 
模型中的领域服务表示一个无状态的操作，他用于实现特定于某个领域的任务。 当领域中某个操作过程或转化过程不是实体或值对象的职责时，我们便应该将该操作放在一个单独的元素中，即领域服务。除此之外，还有基础设施服务和应用服务等

领域服务包含的是业务逻辑，是无状态的。

如果将过多的逻辑推入领域服务中，将导致不准确、难理解、贫血并且低概念的领域模型。所以一般不过多使用领域服务，而是加在实体中


5.领域事件
将一个领域模型的变化通知其他领域模型，实现松耦合
事件通常包括事件类型 事件数据 事件时间三个要素

当一个视频被发布时，会发布一个视频发布的领域事件，会通知其他领域对象，让它们做出处理
在bilibili的视频业务中，有视频上传事件，视频删除事件，视频点赞事件，视频评论事件，视频观看事件

6.事件总线
为了支持事件的发布和订阅，通常需要引入一个事件总线（Event Bus）来负责事件的分发和调度。事件总线可以是一个简单的观察者模式实现，也可以是一个更为复杂的消息队列等实现

7.限界上下文
领域模型的边界，包含了一组相关联的模型元素，比如实体、值对象、聚合根、领域服务、领域事件等。它将整个系统划分为多个相对独立的部分，
例如
用户可以下单购买商品，而订单和商品之间也存在复杂的关系。为了更好地控制和管理这些领域，我们可以将系统划分为多个限界上下文，比如用户上下文、订单上下文、商品上下文等。